<turbo-frame id="frame-reservas" >
    <div class="row justify-content-center">
        <div class="col-md-12">
            <div class="card shadow-sm border-0 rounded-4">
                <div class="card-body">
                    <h5 class="card-title mb-3">Listado de check-in</h5>
                    <div class="table-responsive" style="overflow-x:auto; max-height: 50vh; overflow-y:auto;">
                        <table class="table table-striped table-hover align-middle mb-0 table-sm">
                            <thead class="table-dark">
                                <tr>
                                    <th>Reserva</th>
                                    <th>Cliente</th>
                                    <th>Celular</th>
                                    <th>Fecha/hora de llegada</th>
                                    <th>Fecha/hora de Salida</th>
                                    <th>Habitacion</th>
                                    {% if is_granted('ROLE_CAJA') %}
                                        <th colspan=3 >Acciones</th>
                                    {% endif %}
                                </tr>
                                </thead>
                                <tbody>
                                {% if checkins is not empty %}
                                    {% for checkin in checkins %}
                                        <tr>
                                            <td>
                                                {% if checkin.reserva is not null %}
                                                    {{ checkin.reserva.numero }}
                                                {% else %}
                                                    Sin reserva
                                                {% endif %}
                                            </td>
                                            <td>{{ checkin.cliente.documentNumber }} - {{ checkin.cliente.name }} {{ checkin.cliente.lastname }}</td>
                                            <td>{{ checkin.cliente.cellphone }}</td>
                                            <td>{{ checkin.fechallegada|date('Y-m-d') }} {{ checkin.horallegada|date('H:i') }}</td>
                                            <td>
                                                {% if checkin.fechasalida is not null  %}
                                                    {{ checkin.fechasalida|date('Y-m-d') }} {{ checkin.horasalida|date('H:i') }}</td>
                                                {% endif %}
                                            <td>
                                                {% if checkin.habitacion is not null  %}
                                                    {{ checkin.habitacion.name }}
                                                {% endif %}
                                            </td>
                                            {% if is_granted('ROLE_CAJA') %} 
                                                {% if existeTurno == 1  %}                                        
                                                    {% if checkin.estado == 0 %}
                                                        <td colspan=2 style="text-align:center; width: 20px;">
                                                            <i class="fas fa-check-circle text-primary" style="cursor:pointer" data-action="click->sistema--app#abrirModalCheckin" data-id = {{ checkin.id }} data-cliente = {{ checkin.cliente.id }} ></i>
                                                        </td>
                                                    {% elseif checkin.estado == 1 %}
                                                        <td style="text-align:center; width: 20px;">
                                                            <i class="far fa-window-maximize text-primary" style="cursor:pointer" data-action="click->sistema--app#abrirModalCheckOut" data-id = {{ checkin.id }} data-accion = '2'></i>
                                                        </td>
                                                        <td style="text-align:center; width: 20px;">
                                                            <i class="fas fa-concierge-bell text-success" style="cursor:pointer; font-size:18px" data-action="click->sistema--app#abrirModalServicio" data-id = {{ checkin.id }} data-habitacion = {{ checkin.habitacion.name }}></i>
                                                        </td>
                                                        <td style="text-align:center; width: 20px;">
                                                            <i class="fas fa-cart-plus text-success" style="cursor:pointer" data-action="click->sistema--app#abrirModalProductos" data-id = {{ checkin.id }} data-habitacion = {{ checkin.habitacion.name }} ></i>
                                                        </td>
                                                    {% else %}
                                                        <td colspan=3 style="text-align:end; width: 20px;">
                                                            <span class="badge bg-danger" data-action="click->sistema--app#verFactura" data-id = {{ checkin.id }} title="Ver factura" style="cursor:pointer" >Finalizado</span>
                                                        </td>
                                                    {% endif %}
                                                {% else %}
                                                    {% if checkin.estado == 2 %}
                                                        <td colspan=3 style="text-align:center; width: 20px;">
                                                            <span class="badge bg-danger" data-action="click->sistema--app#verFactura" data-id = {{ checkin.id }} title="Ver factura" style="cursor:pointer" >Finalizado</span>
                                                        </td>
                                                    {% else %}
                                                        <td colspan=3 style="text-align:center; width: 20px;">
                                                            <span class="badge bg-secondary" style="cursor:pointer" >Abrir turno</span>
                                                        </td>
                                                    {% endif %}
                                                {% endif %}
                                                {% if checkin.estado == 0 %}
                                                    <td style="text-align:left; width: 20px;">
                                                        <i class="fas fa-trash-restore-alt text-danger" style="cursor:pointer" data-action="click->sistema--app#eliminarCheckin" data-id = {{ checkin.id }} ></i>
                                                    </td>
                                                {% endif %}
                                            {% endif %}
                                        </tr>
                                    {% endfor %}
                                {% else %}
                                    <tr>
                                        <td colspan="9" class="text-center text-muted">No hay reservas registradas</td>
                                    </tr>
                                {% endif %}
                            
                                
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="mt-3 d-flex justify-content-space-between" style="margin:20px">
                    <button type="button" class="btn btn-primary btn-sm" style="margin-right:10px" {% if existeTurno == 1 %} data-action="click->sistema--app#abrirModalCheckin" data-id = "" data-cliente = "" {% else %} disabled {% endif %}  >Nuevo</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para hacer check-in -->
    <div class="modal fade" id="modalCheckin" data-turbo="false" data-sistema--app-target="modalCheckin" tabindex="-1" aria-labelledby="modalCheckinLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <input type="hidden" name="idCheckin" id="numCheckin"  value="1">
                <div class="modal-header">
                    <h5 class="modal-title"><span data-sistema--app-target="modalCheckinLabel">Check-in</span></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" data-sistema--app-target="modalBodyCheckin">
                    <div id="checkin-1">
                        <form data-sistema--app-target="formCheckin">
                            <input type="hidden" name="idCheckin" id="idCheckin"  value="0">
                            <input type="hidden" name="idHab" id="idHab"  value="0">
                            <input type="hidden" name="productos" id="productos"  value="0">
                            <input type="hidden" name="servicios" id="servicios"  value="0">
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <label for="${selectId}" class="form-label mb-0" style="font-weight: bold;">Cliente <i class="fas fa-exclamation-circle text-info" title="Crear cliente" style="" data-action="click->sistema--app#abrirModalNuevoCliente" data-accion="1"></i></label>
                                        <div class="d-flex justify-content-end align-items-center">
                                            {#<div class="form-check form-check-inline">
                                                <input class="form-check-input" type="radio" name="tipoClienteCheckin" id="motoristaCheckin-1" value="motorista" checked>
                                                <label class="form-check-label" for="motoristaCheckin-1" style="font-weight: normal;">Motorista</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input" type="radio" name="tipoClienteCheckin" id="turistaCheckin-1" value="turista">
                                                <label class="form-check-label" for="turistaCheckin-1" style="font-weight: normal;">Turista</label>
                                            </div>#}
                                        </div>
                                    </div>
                                    <div class="input-group mt-1">
                                        <select id="clienteSelectCustom-1" class="form-control selectpicker"  data-live-search="true" data-live-search-placeholder="Filtro clientes" data-size="5" title="Seleccione cliente" name="clienteRev" data-sistema--app-target="clienteRev">
                                            {% for cliente in clientes %}
                                                <option value="{{ cliente.id }}">{{ cliente.documentNumber }} - {{ cliente.name }} {{ cliente.lastname }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                </div>                                    
                                <div class="col-md-2">
                                    <label for="fechaLlegada" class="form-label" style="font-weight: bold;">Fecha llegada</label>
                                    <input type="date" id="fechaLlegada" name="fechaLlegClienteRev" class="form-control" value="" min="" data-action="blur->sistema--app#recalcularFechaSalida">
                                </div>
                                <div class="col-md-2">
                                    <label for="horaLlegada" class="form-label" style="font-weight: bold;">Hora llegada</label>
                                    <input type="time" id="horallegada" name="horaLlegClienteRev" class="form-control" value="" min="" data-action="blur->sistema--app#recalcularFechaSalida">
                                </div>
                                <div class="col-md-2">
                                    <label for="fechaSalida" class="form-label" style="font-weight: bold;">Fecha salida</label>
                                    <input type="date" id="fechaSalida" name="fechaSalidaClienteRev" class="form-control" value="" min="">
                                </div>
                                <div class="col-md-2">
                                    <label for="horaSalida" class="form-label" style="font-weight: bold;">Hora salida</label>
                                    <input type="time" id="horaSalida" name="horaSalidaClienteRev" class="form-control" value="" min="">
                                </div>                                
                            </div>
                            <div class="row mt-3">
                                <div class="col-12">
                                    <div class="table-responsive">
                                        <table class="table table-bordered table-sm align-middle mb-0">
                                            <thead class="table-light">
                                                <tr>
                                                    <th colspan="2" class="text-nowrap"><i class="fas fa-plus-circle text-success" style="cursor:pointer; font-weight: bold; margin-right:10px" data-action="click->sistema--app#abrirModalServicioCheckin"></i> Servicio</th>
                                                    <th class="text-nowrap">Habitación</th>
                                                    <th class="text-nowrap">Forma de pago</th>
                                                    <th class="text-nowrap">N°</th>
                                                    <th class="text-nowrap">Valor servicio</th>
                                                    <th class="text-nowrap">Descuento</th>
                                                    <th class="text-nowrap">Valor</th>
                                                    <th class="text-nowrap">Saldo</th>
                                                    <th class="text-nowrap">Valor pagado</th>
                                                </tr>
                                            </thead>
                                            <tbody id="serviciosCheckin-1">
                                                <tr>
                                                    <td colspan=8 style="text-align:center" >No se han registrado servicios</td>
                                                </tr>                                                    
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-3">
                                <div class="col-12">
                                    <div class="table-responsive">
                                        <table class="table table-bordered table-sm align-middle mb-0">
                                            <thead class="table-light">
                                                <tr>
                                                    <th colspan="2" class="text-nowrap"><i class="fas fa-cart-plus text-success" style="cursor:pointer; font-weight: bold; margin-right:10px" data-action="click->sistema--app#abrirModalProductosCheckin"></i> Producto</th>
                                                    <th class="text-nowrap">Forma de pago</th>
                                                    <th class="text-nowrap">Cantidad</th>
                                                    <th class="text-nowrap">Valor und</th>
                                                    <th class="text-nowrap">Total</th>
                                                    <th class="text-nowrap">Saldo</th>
                                                    <th class="text-nowrap">Valor pagado</th>
                                                </tr>
                                            </thead>
                                            <tbody id="productosCheckin-1">
                                                <tr>
                                                    <td colspan=8 style="text-align:center" >No se han registrado productos</td>
                                                </tr>                                                    
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-3">
                                <div class="col-md-4 d-flex align-items-center">
                                    <div class="w-100">
                                        <label class="form-label mb-1" style="font-weight: bold;">Elementos entregados</label><br>
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input" type="checkbox" id="checkTodos-1" data-action="sistema--app#marcarElementos" data-index="1"  value="">
                                                    <label class="form-check-label" for="checkToalla">Todos</label>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input check-1" type="checkbox" id="checkToalla" name="Toalla"  data-action="sistema--app#marcarElemento" data-index="1">
                                                    <label class="form-check-label" for="checkToalla">Toalla</label>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input check-1" type="checkbox" id="checkControl" name="control" data-action="sistema--app#marcarElemento" data-index="1">
                                                    <label class="form-check-label" for="checkControl">Control</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input check-1" type="checkbox" id="checkAire" name="aire" value="" data-action="sistema--app#marcarElemento" data-index="1">
                                                    <label class="form-check-label" for="checkAire">Aire</label>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input check-1" type="checkbox" id="checkCobija" name="cobija" value="" data-action="sistema--app#marcarElemento" data-index="1">
                                                    <label class="form-check-label" for="checkCobija">Cobija</label>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input check-1" type="checkbox" id="checkLlaves" name="llaves" value="" data-action="sistema--app#marcarElemento" data-index="1" checked>
                                                    <label class="form-check-label" for="checkLlaves">Llaves</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <label for="observacionesCheckin" class="form-label" style="font-weight: bold;">Observaciones</label> 
                                    <textarea id="observacionesCheckin" name="observacionesCheckin" class="form-control" rows="2" data-sistema--app-target="observacionesCheckin" placeholder="Ingrese sus observaciones aquí"></textarea>
                                </div>
                                <div class="col-md-2">
                                    <label class="form-label" style="font-weight: bold;">Total a pagar</label> 
                                    </br><span id="totalPagar-1" class="text-success" style=" font-size: 26pt; font-weight: bold;">$ 0</span>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>  
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-sistema--app-target="btnGuardarReserva" data-action="sistema--app#hacerCheckin">Guardar</button>
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para registrar servicios -->
    <div class="modal fade" id="modalNuevoServicioCheckin" data-sistema--app-target="modalNuevoServicioCheckin" tabindex="-1" aria-labelledby="modalNuevoServicioCheckinLabel" aria-hidden="true" style="margin-top:25px !important;">
        <div class="modal-dialog modal-lg">
            <div class="modal-content shadow-lg" style="box-shadow: 0 1.5rem 3.5rem 1rem rgba(33,37,41,0.98) !important;">
                <div class="modal-header">
                    <h5 class="modal-title">Registro de servicios</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>            
                <div class="modal-body">
                    <input type="hidden" id="valHorasServ" value="0" />
                    <div class="row mb-3">
                        <div class="col-md-12">
                            <label for="selectServ" class="form-label" style="font-weight: bold;">Servicio</label> 
                            <select class="form-select" id="selectServ" name="selectServ" data-sistema--app-target="selectServ"  data-action="change->sistema--app#cargarServicioCheckin change->sistema--app#validaBtnGuardarServicioCheckin">
                                <option value="">Seleccione servicio</option>    
                                {% for servicio in servicios %}
                                    <option value="{{ servicio.id }}">{{ servicio.name }} {% if servicio.hours is not null %} / {{ servicio.hours }} horas {% endif %} </option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-8">
                            <label for="selectHabitacionServ" class="form-label" style="font-weight: bold;">Habitación</label> 
                            <select class="form-select" id="selectHabitacionServ" name="selectHabitacionServ" data-sistema--app-target="selectHabitacionServ"  data-action="change->sistema--app#cargarHab change->sistema--app#validaBtnGuardarServicioCheckin ">
                                <option value="">Seleccione habitación</option>                                
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label for="inputCantidadServicio" class="form-label" style="font-weight: bold;">Cantidad</label> 
                            <input type="text" id="inputCantidadServicio" name="inputCantidadServicio" class="form-control" data-sistema--app-target="inputCantidadServicio" value="1" data-action="blur->sistema--app#calcularNuevoValorServ">
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-3">
                            <label for="tipoDoc" class="form-label" style="font-weight: bold;">Valor</label> 
                            <input type="text" name="numeroDocCliente" class="form-control" data-sistema--app-target="valorServCheckin" disabled>
                        </div>
                        <div class="col-md-3">
                            <label for="tipoDoc" class="form-label" style="font-weight: bold;">Descuento</label> 
                            <input type="text" name="numeroDocCliente" class="form-control" value='0' data-sistema--app-target="descuentoServCheckin" data-action="sistema--app#formatearCampo blur->sistema--app#aplicaDescuentoCheckin blur->sistema--app#actualizaSaldoCheckin blur->sistema--app#validaBtnGuardarServicioCheckin" >
                        </div>
                        <div class="col-md-3">
                            <label for="tipoDoc" class="form-label" style="font-weight: bold;">Valor pagado</label> 
                            <input type="text" name="numeroDocCliente" class="form-control" data-sistema--app-target="valorPagServCheckin" data-action="sistema--app#formatearCampo blur->sistema--app#actualizaSaldoCheckin blur->sistema--app#validaBtnGuardarServicioCheckin">
                        </div>
                        <div class="col-md-3">
                            <label for="tipoDoc" class="form-label" style="font-weight: bold;">Saldo</label> 
                            <input type="text" name="numeroDocCliente" class="form-control" data-sistema--app-target="saldoServCheckin" disabled>
                        </div>
                    </div>
                    <div class="row mb-3">                        
                        <div class="col-md-6">
                            <label for="selectFormaPagoCheckin" class="form-label" style="font-weight: bold;">Forma de pago</label> 
                            <select class="form-select" id="selectFormaPagoCheckin" name="selectFormaPagoCheckin" data-sistema--app-target="selectFormaPagoCheckin"  data-action="change->sistema--app#actualizarComprobante change->sistema--app#validaBtnGuardarServicioCheckin">
                                <option value="">Seleccione forma de pago</option>                     
                                <option value="1">Efectivo</option>                     
                                <option value="2">Voucher</option>                     
                                <option value="3">Transaccion</option>                     
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label for="tipoDoc" class="form-label" style="font-weight: bold;">N° comprobante</label> 
                            <input type="text" name="numeroDocCliente" class="form-control" data-sistema--app-target="comprobanteCheckin" disabled data-action="blur->sistema--app#validaBtnGuardarServicioCheckin">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-sistema--app-target="btnGuardarServicioCheckin" data-action="sistema--app#guardarServicioCheckin" disabled>Guardar</button>
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para registrar productos -->
    <div class="modal fade" id="modalNuevoProductoCheckin" data-sistema--app-target="modalNuevoProductoCheckin" tabindex="-1" aria-labelledby="modalNuevoServicioCheckinLabel" aria-hidden="true" style="margin-top:25px !important;">
        <div class="modal-dialog">
            <div class="modal-content shadow-lg" style="box-shadow: 0 1.5rem 3.5rem 1rem rgba(33,37,41,0.98) !important;">
                <div class="modal-header">
                    <h5 class="modal-title">Registro de productos</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>            
                <div class="modal-body">
                    <input type="hidden" id="cantProd" value="0" />
                    <input type="hidden" id="valPro" value="0" />
                    <div class="row mb-3">
                        <div class="col-md-8">
                            <label for="selectProductoCheckin" class="form-label" style="font-weight: bold;">Producto</label> 
                            <select class="form-select" id="selectProductoCheckin" name="selectProductoCheckin" data-sistema--app-target="selectProductoCheckin"  data-action="change->sistema--app#cargarProductoCheckin change->sistema--app#validaBtnGuardarProdeuctoCheckin">
                                <option value="">Seleccione producto</option>    
                                {% for producto in productos %}
                                    <option value="{{ producto.id }}">{{ producto.codigo }} - {{ producto.nombre }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label for="valorProductorCheckin" class="form-label" style="font-weight: bold;">Valor</label> 
                            <input type="text" name="valorProductorCheckin" class="form-control" data-sistema--app-target="valorProductorCheckin" disabled>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <label for="cantProductoCheckin" class="form-label" style="font-weight: bold;">Cantidad</label> 
                            <input type="text" name="cantProductoCheckin" class="form-control" data-sistema--app-target="cantProductoCheckin" data-action="sistema--app#formatearCampo blur->sistema--app#calculaValorProductos blur->sistema--app#validaBtnGuardarProdeuctoCheckin">
                        </div>
                        <div class="col-md-4">
                            <label for="valorPagoProductoCheckin" class="form-label" style="font-weight: bold;">Valor pagado</label> 
                            <input type="text" name="valorPagoProductoCheckin" class="form-control" data-sistema--app-target="valorPagoProductoCheckin" data-action="sistema--app#formatearCampo blur->sistema--app#actualizaSaldoProdCheckin blur->sistema--app#validaBtnGuardarProdeuctoCheckin">
                        </div>
                        <div class="col-md-4">
                            <label for="saldoProductoCheckin" class="form-label" style="font-weight: bold;">Saldo</label> 
                            <input type="text" name="saldoProductoCheckin" class="form-control" data-sistema--app-target="saldoProductoCheckin" disabled>
                        </div>
                    </div>
                    <div class="row mb-3">                        
                        <div class="col-md-8">
                            <label for="selectFormaPagoProductoCheckin" class="form-label" style="font-weight: bold;">Forma de pago</label> 
                            <select class="form-select" id="selectFormaPagoProductoCheckin" name="selectFormaPagoProductoCheckin" data-sistema--app-target="selectFormaPagoProductoCheckin"  data-action="change->sistema--app#actualizarComprobanteProducto change->sistema--app#validaBtnGuardarProdeuctoCheckin">
                                <option value="">Seleccione forma de pago</option>                     
                                <option value="1">Efectivo</option>                     
                                <option value="2">Voucher</option>                     
                                <option value="3">Transaccion</option>                     
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label for="comprobanteProductoCheckin" class="form-label" style="font-weight: bold;">N° comprobante</label> 
                            <input type="text" name="comprobanteProductoCheckin" class="form-control" data-sistema--app-target="comprobanteProductoCheckin" disabled data-action="blur->sistema--app#validaBtnGuardarProdeuctoCheckin">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-sistema--app-target="btnGuardarProductoCheckin" data-action="sistema--app#guardarProductosCheckin" disabled>Guardar</button>
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para hacer check-out -->
    <div class="modal fade" id="modalCheckout" data-turbo="false" data-sistema--app-target="modalCheckout" tabindex="-1" aria-labelledby="modalCheckoutLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <input type="hidden" name="idCheckout" id="idCheckout"  value="0">
                <div class="modal-header">
                    <h5 class="modal-title">Check-out</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="checkin-1">
                        <form data-sistema--app-target="formCheckin">
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <label class="form-label mb-0" style="font-weight: bold;">Cliente</i></label>
                                        <div class="d-flex justify-content-end align-items-center">                                            
                                            <label class="form-check-label" for="tipoClienteOut" id="tipoClienteOut" style="font-weight: normal;"></label>                                            
                                        </div>
                                    </div>
                                    <div class="input-group mt-1">
                                        <input class="form-control" id="clienteCheckout" type="text" value="" disabled >
                                    </div>
                                </div>                                    
                                <div class="col-md-2">
                                    <label for="fechaLlegada" class="form-label" style="font-weight: bold;">Fecha llegada</label>
                                    <input type="date" class="form-control" id="fechaLlegadaOut" value="" disabled>
                                </div>
                                <div class="col-md-2">
                                    <label for="horaLlegada" class="form-label" style="font-weight: bold;">Hora llegada</label>
                                    <input type="time" class="form-control" id="horaLlegadaOut" value="" disabled>
                                </div>
                                <div class="col-md-2">
                                    <label for="fechaSalida" class="form-label" style="font-weight: bold;">Fecha salida</label>
                                    <input type="date" id="fechaSalidaOut" name="fechaSalidaClienteRev" class="form-control" value="" min="">
                                </div>
                                <div class="col-md-2">
                                    <label for="horaSalida" class="form-label" style="font-weight: bold;">Hora salida</label>
                                    <input type="time" id="horaSalidaOut" name="horaSalidaClienteRev" class="form-control" value="" min="">
                                </div>                                
                            </div>
                            <div class="row mt-3">
                                <div class="col-12">
                                    <div class="table-responsive">
                                        <table class="table table-bordered table-sm align-middle mb-0">
                                            <thead class="table-light">
                                                <tr>
                                                    <th class="text-nowrap">Servicio</th>
                                                    <th class="text-nowrap">Habitación</th>
                                                    <th class="text-nowrap">Forma de pago</th>
                                                    <th class="text-nowrap">N°</th>
                                                    <th class="text-nowrap">Valor servicio</th>
                                                    <th class="text-nowrap">Cant</th>
                                                    <th class="text-nowrap">Descuento</th>
                                                    <th class="text-nowrap">Valor</th>
                                                    <th class="text-nowrap">Valor pagado</th>
                                                    <th class="text-nowrap">Saldo</th>
                                                </tr>
                                            </thead>
                                            <tbody id="serviciosCheckout">
                                                                                                
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-3">
                                <div class="col-12">
                                    <div class="table-responsive">
                                        <table class="table table-bordered table-sm align-middle mb-0">
                                            <thead class="table-light">
                                                <tr>
                                                    <th class="text-nowrap">Producto</th>
                                                    <th class="text-nowrap">Forma de pago</th>
                                                    <th class="text-nowrap">Cantidad</th>
                                                    <th class="text-nowrap">Valor und</th>
                                                    <th class="text-nowrap">Total</th>
                                                    <th class="text-nowrap">Valor pagado</th>
                                                    <th class="text-nowrap">Saldo</th>
                                                </tr>
                                            </thead>
                                            <tbody id="productosCheckout">                                               
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-3">
                                <div class="col-md-4 d-flex align-items-center">
                                    <div class="w-100">
                                        <label class="form-label mb-1" style="font-weight: bold;">Elementos entregados</label><br>
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input" type="checkbox" id="checkTodosOut" data-action="sistema--app#marcarElementos" data-index="1"  value="">
                                                    <label class="form-check-label" for="checkToalla">Todos</label>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input check-1" type="checkbox" id="checkToallaOut" name="Toalla"  data-action="sistema--app#marcarElemento" data-index="1">
                                                    <label class="form-check-label" for="checkToalla">Toalla</label>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input check-1" type="checkbox" id="checkControlOut" name="control" data-action="sistema--app#marcarElemento" data-index="1">
                                                    <label class="form-check-label" for="checkControl">Control</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input check-1" type="checkbox" id="checkAireOut" name="aire" value="" data-action="sistema--app#marcarElemento" data-index="1">
                                                    <label class="form-check-label" for="checkAire">Aire</label>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input check-1" type="checkbox" id="checkCobijaOut" name="cobija" value="" data-action="sistema--app#marcarElemento" data-index="1">
                                                    <label class="form-check-label" for="checkCobija">Cobija</label>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input check-1" type="checkbox" id="checkLlavesOut" name="llaves" value="" data-action="sistema--app#marcarElemento" data-index="1" checked>
                                                    <label class="form-check-label" for="checkLlaves">Llaves</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <label for="observacionesCheckin" class="form-label" style="font-weight: bold;">Observaciones</label> 
                                    <textarea id="observacionesCheckOut" name="observacionesCheckOut" class="form-control" rows="2" readonly></textarea>
                                </div>
                                <div class="col-md-2">
                                    <label class="form-label" style="font-weight: bold;">Saldo a pagar</label> 
                                    </br><span id="saldoPagar" class="text-success" style=" font-size: 26pt; font-weight: bold;">$ 0</span>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>  
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-sistema--app-target="btnGuardarReserva" data-action="sistema--app#checkout">Finalizar</button>
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para factura -->
    <div class="modal fade" id="modalFactura" data-turbo="false" data-sistema--app-target="modalFactura" tabindex="-1" aria-labelledby="modalFacturaLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <input type="hidden" name="idCheckout" id="idCheckout"  value="0">
                <div class="modal-header">
                    <h5 class="modal-title">Factura</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <iframe id="frame-pdfLiq" style="width:100%; height:500px; border:1px solid;" class="PDF" src=""></iframe>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para registrar servicios checkin -->
    <div class="modal fade" id="nuevoServicioCheckin" data-sistema--app-target="nuevoServicioCheckin" tabindex="-1" aria-labelledby="nuevoServicioCheckinLabel" aria-hidden="true" style="margin-top:25px !important;">
        <div class="modal-dialog modal-lg">
            <div class="modal-content shadow-lg" style="box-shadow: 0 1.5rem 3.5rem 1rem rgba(33,37,41,0.98) !important;">
                <div class="modal-header">
                    <h5 class="modal-title">Registro de servicios</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>            
                <div class="modal-body">
                    <input type="hidden" id="idCheckinNewService" value="0" />
                    <div class="row mb-3">
                        <div class="col-md-2">
                            <label for="selectServ" class="form-label" style="font-weight: bold;">Habitación</label> 
                            <input class="form-control" id="NumHabitacion" value="" readonly/>
                        </div>
                        <div class="col-md-6">
                            <label for="selectServ" class="form-label" style="font-weight: bold;">Servicio</label> 
                            <select class="form-select" id="selectNewServ" name="selectServ"  data-action="change->sistema--app#cargarnewServicioCheckin change->sistema--app#validaBtnCargarNewServicio">
                                <option value="">Seleccione servicio</option>    
                                {% for servicio in serviciosCheck %}
                                    <option value="{{ servicio.id }}">{{ servicio.name }} {% if servicio.hours is not null %} / {{ servicio.hours }} horas {% endif %} </option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="col-md-2">
                            <label for="tipoDoc" class="form-label" style="font-weight: bold;">Valor</label> 
                            <input type="text" name="numeroDocCliente" class="form-control" id="valorNewService" disabled>
                        </div>
                        <div class="col-md-2">
                            <label for="tipoDoc" class="form-label" style="font-weight: bold;">Cantidad</label> 
                            <input type="text" name="numeroDocCliente" class="form-control" id="cantidadNewService" value="1" data-action="sistema--app#formatearCampo blur->sistema--app#actualizaValorNewService blur->sistema--app#validaBtnCargarNewServicio">
                        </div>
                    </div>
                    <div class="row mb-3">                        
                        <div class="col-md-3">
                            <label for="tipoDoc" class="form-label" style="font-weight: bold;">Valor pagado</label> 
                            <input type="text" name="numeroDocCliente" class="form-control" id="valorPagNewService" data-action="sistema--app#formatearCampo blur->sistema--app#actualizaSaldoNewService blur->sistema--app#validaBtnCargarNewServicio">
                        </div>
                        <div class="col-md-2">
                            <label for="tipoDoc" class="form-label" style="font-weight: bold;">Saldo</label> 
                            <input type="text" name="numeroDocCliente" class="form-control" id="saldoNewService" disabled>
                        </div>
                        <div class="col-md-4">
                            <label for="selectFormaPagoCheckin" class="form-label" style="font-weight: bold;">Forma de pago</label> 
                            <select class="form-select" id="selectFormaPagoNewService" name="selectFormaPagoCheckin" data-action="change->sistema--app#actualizarComprobanteNewService change->sistema--app#validaBtnCargarNewServicio">
                                <option value="">Seleccione forma de pago</option>                     
                                <option value="1">Efectivo</option>                     
                                <option value="2">Voucher</option>                     
                                <option value="3">Transaccion</option>                     
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label for="tipoDoc" class="form-label" style="font-weight: bold;">N° comprobante</label> 
                            <input type="text" name="numeroDocCliente" class="form-control" id="comprobanteNewService" disabled data-action="blur->sistema--app#validaBtnCargarNewServicio">
                        </div>
                    </div>

                    <div class="row mt-3">
                        <div class="col-12">
                            <div class="table-responsive">
                                <table class="table table-bordered table-sm align-middle mb-0">
                                    <thead class="table-light">
                                        <tr>
                                            <th colspan="2" class="text-nowrap">
                                                <i class="fas fa-plus-circle" id="btnCaragarNewService1" style="cursor:pointer; font-weight: bold; margin-right:10px; color:#7dc3ab;"></i>
                                                <i class="fas fa-plus-circle text-success" id="btnCaragarNewService2" style="cursor:pointer; font-weight: bold; margin-right:10px; display: none " data-action="click->sistema--app#cargarNewServicio"></i> 
                                                Servicio
                                            </th>
                                            <th class="text-nowrap">Forma de pago</th>
                                            <th class="text-nowrap">Comprobante</th>
                                            <th class="text-nowrap">Valor</th>
                                            <th class="text-nowrap">Cantidad</th>
                                            <th class="text-nowrap">Valor pagado</th>
                                            <th class="text-nowrap">Saldo</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tablaNewsServices">
                                        <tr>
                                            <td colspan=8 style="text-align:center" >No se han registrado servicios</td>
                                        </tr>                                                    
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="btnGuardarNweServicio" data-action="sistema--app#guardarnewServicio" disabled>Guardar</button>
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
                </div>
            </div>
        </div>
    </div>

     <!-- Modal para registrar productos checkin -->
    <div class="modal fade" id="nuevoProductoCheckin" data-sistema--app-target="nuevoProductoCheckin" tabindex="-1" aria-labelledby="nuevoServicioCheckinLabel" aria-hidden="true" style="margin-top:25px !important;">
        <div class="modal-dialog modal-lg">
            <div class="modal-content shadow-lg" style="box-shadow: 0 1.5rem 3.5rem 1rem rgba(33,37,41,0.98) !important;">
                <div class="modal-header">
                    <h5 class="modal-title">Registro de productos</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>            
                <div class="modal-body">
                    <input type="hidden" id="idCheckProducto" value="0" />
                    <div class="row mb-3">
                        <div class="col-md-2">
                            <label for="valorProductorCheckin" class="form-label" style="font-weight: bold;">Habitación</label> 
                            <input type="text" name="valorProductorCheckin" class="form-control" id="habitacionNewProducto" readonly>
                        </div>
                        <div class="col-md-6">
                            <label for="selectProductoCheckin" class="form-label" style="font-weight: bold;">Producto</label> 
                            <select class="form-select" name="selectProductoCheckin" id="selectProductoNewCheckin"  data-action="change->sistema--app#cargarNewProductoCheckin change->sistema--app#validaBtnCargarnewProductoCheckin">
                                <option value="">Seleccione producto</option>    
                                {% for producto in productos %}
                                    <option value="{{ producto.id }}">{{ producto.codigo }} - {{ producto.nombre }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="col-md-2">
                            <label for="valorProductorCheckin" class="form-label" style="font-weight: bold;">Valor</label> 
                            <input type="text" name="valorProductorCheckin" class="form-control" id="valorNewProductorCheckin" disabled>
                        </div>
                        <div class="col-md-2">
                            <label for="cantProductoCheckin" class="form-label" style="font-weight: bold;">Cantidad</label> 
                            <input type="text" name="cantProductoCheckin" class="form-control" id="cantProductoNewCheckin" data-action="sistema--app#formatearCampo blur->sistema--app#calculaValorNewProductos blur->sistema--app#validaBtnCargarnewProductoCheckin">
                        </div>
                    </div>
                    <div class="row mb-3">                        
                        <div class="col-md-2">
                            <label for="valorPagoProductoCheckin" class="form-label" style="font-weight: bold;">Valor pagado</label> 
                            <input type="text" name="valorPagoProductoCheckin" class="form-control" id="valorPagoNewProducto" data-action="sistema--app#formatearCampo blur->sistema--app#actualizaSaldoProdNewCheckin blur->sistema--app#validaBtnCargarnewProductoCheckin">
                        </div>
                        <div class="col-md-2">
                            <label for="saldoProductoCheckin" class="form-label" style="font-weight: bold;">Saldo</label> 
                            <input type="text" name="saldoProductoCheckin" class="form-control" id="saldoProductoNewCheckin" disabled>
                        </div>
                        <div class="col-md-4">
                            <label for="selectFormaPagoProductoCheckin" class="form-label" style="font-weight: bold;">Forma de pago</label> 
                            <select class="form-select" id="selectFormaPagoNewProductoCheckin" name="selectFormaPagoProductoCheckin" data-action="change->sistema--app#actualizarComprobanteNewProducto change->sistema--app#validaBtnCargarnewProductoCheckin">
                                <option value="">Seleccione forma de pago</option>                     
                                <option value="1">Efectivo</option>                     
                                <option value="2">Voucher</option>                     
                                <option value="3">Transaccion</option>                     
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label for="comprobanteProductoCheckin" class="form-label" style="font-weight: bold;">N° comprobante</label> 
                            <input type="text" name="comprobanteProductoCheckin" class="form-control" id="comprobanteNewProductoCheckin" disabled data-action="blur->sistema--app#validaBtnCargarnewProductoCheckin">
                        </div>
                    </div>
                    <div class="row mt-3">
                        <div class="col-12">
                            <div class="table-responsive">
                                <table class="table table-bordered table-sm align-middle mb-0">
                                    <thead class="table-light">
                                        <tr>
                                            <th colspan="2" class="text-nowrap">
                                                <i class="fas fa-cart-plus" id="btnCaragarNewProducto1" style="cursor:pointer; font-weight: bold; margin-right:10px; color:#7dc3ab;"></i>
                                                <i class="fas fa-cart-plus text-success" id="btnCaragarNewProducto2" style="cursor:pointer; font-weight: bold; margin-right:10px; display: none " data-action="click->sistema--app#cargarNewProducto"></i> 
                                                Producto
                                            </th>
                                            <th class="text-nowrap">Forma de pago</th>
                                            <th class="text-nowrap">Cantidad</th>
                                            <th class="text-nowrap">Valor und</th>
                                            <th class="text-nowrap">Total</th>
                                            <th class="text-nowrap">Valor pagado</th>
                                            <th class="text-nowrap">Saldo</th>
                                        </tr>
                                    </thead>
                                    <tbody id="productosNewCheckin">
                                        <tr>
                                            <td colspan=8 style="text-align:center" >No se han registrado productos</td>
                                        </tr>                                                    
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="btnGuardarProductoNewCheckin" data-action="sistema--app#guardarProductosNewCheckin" disabled>Guardar</button>
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para registrar clientes -->
    <div class="modal fade" id="modalNuevoCliente" data-sistema--app-target="modalNuevoCliente" tabindex="-1" aria-labelledby="modalNuevoClienteLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
            <h5 class="modal-title"><span data-sistema--app-target="modalClienteLabel"></span></h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form data-sistema--app-target="formNuevoCliente">
            <input type="hidden" name="id" data-sistema--app-target="idCliente" value="0">
            <div class="modal-body">
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="tipoDoc" class="form-label" style="font-weight: bold;">Tipo de documento</label> 
                        <select class="form-select" id="tipoDoc" name="tipoDoc" data-sistema--app-target="selectTipoDocCliente"  data-action="change->sistema--app#validaBtnGuardarCliente">
                            <option value="">Seleccione tipo de documento</option>
                            {% for document in documents %}
                                <option value="{{ document.id }}">{{ document.name }}</option>
                            {% endfor %}                        
                        </select>
                    </div>
                    <div class="col-md-6">
                        <label for="numeroDocCliente" class="form-label" style="font-weight: bold;">Numero de documento</label> 
                        <input type="text" name="numeroDocCliente" class="form-control" id="numeroDocCliente" data-sistema--app-target="numeroDocCliente" placeholder="Ingrese el numero de documento" data-action="blur->sistema--app#validaBtnGuardarCliente">
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="nombresCliente" class="form-label" style="font-weight: bold;">Nombres</label> 
                        <input type="text" name="nombresCliente" class="form-control" id="nombresCliente" data-sistema--app-target="nombresCliente" placeholder="Ingrese los nombres" data-action="blur->sistema--app#validaBtnGuardarCliente">
                    </div>
                    <div class="col-md-6">
                        <label for="apellidosCliente" class="form-label" style="font-weight: bold;">Apellidos</label> 
                        <input type="text" name="apellidosCliente" class="form-control" id="apellidosCliente" data-sistema--app-target="apellidosCliente" placeholder="Ingrese los apellidos" data-action="blur->sistema--app#validaBtnGuardarCliente">
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="numeroCelCliente" class="form-label" style="font-weight: bold;">Numero Celular</label> 
                        <input type="text" name="numeroCelCliente" class="form-control" id="numeroCelCliente" data-sistema--app-target="numeroCelCliente" placeholder="Ingrese el numero de celular" data-action="blur->sistema--app#validaBtnGuardarCliente">
                    </div>
                    <div class="col-md-6">
                        <label for="placaCliente" class="form-label" style="font-weight: bold;">Placa</label> 
                        <input type="text" name="placaCliente" class="form-control" id="placaCliente" data-sistema--app-target="placaCliente" placeholder="Ingrese el numero de la placa" data-action="blur->sistema--app#validaBtnGuardarCliente">
                    </div>
                </div>              
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="numeroVehiculoCliente" class="form-label" style="font-weight: bold;">Numero de vehiculo</label> 
                        <input type="text" name="numeroVehiculoCliente" class="form-control" id="numeroVehiculoCliente" data-sistema--app-target="numeroVehiculoCliente" placeholder="Ingrese el numero del vehiculo" data-action="blur->sistema--app#validaBtnGuardarCliente">
                    </div>
                    <div class="col-md-6">
                        <label for="selectCompaniaCliente" class="form-label" style="font-weight: bold;">Compañia</label> 
                        <select class="form-select" id="selectCompaniaCliente" name="selectCompaniaCliente" data-sistema--app-target="selectCompaniaCliente"  data-action="change->sistema--app#validaBtnGuardarCliente">
                            <option value="">Seleccione compañia</option>
                            {% for compania in companias %}
                                <option value="{{ compania.id }}">{{ compania.name }}</option>
                            {% endfor %}                        
                        </select>
                    </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-sistema--app-target="btnGuardarCliente" data-action="sistema--app#guardarClienteCheckin" disabled>Guardar</button>
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
            </div>
            </form>
        </div>
        </div>
    </div>

    
</turbo-frame>