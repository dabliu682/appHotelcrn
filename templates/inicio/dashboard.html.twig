<turbo-frame id="frame-Dashboard">
    <style>
        /* Igualar altura de los cards de habitaciones en el modal */
        .card-habitacion {
            min-height: 80px;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            margin-bottom: 0.5rem;
        }
        .card-habitacion .card-body {
            flex: 1 1 auto;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 0.5rem !important;
        }
        @media (min-width: 768px) {
            .modal-body .row.g-2 > [class^="col-"] {
                flex: 0 0 auto;
                width: 16.6667%; /* 6 cards per row on md+ */
                max-width: 16.6667%;
            }
        }
        @media (min-width: 1200px) {
            .modal-body .row.g-2 > [class^="col-"] {
                width: 12.5%; /* 8 cards per row on xl+ */
                max-width: 12.5%;
            }
        }
        @media (max-width: 991.98px) {
            .table-responsive { max-height: 200px !important; }
            .table { font-size: 0.95rem; }
        }
        @media (max-width: 767.98px) {
            .table-responsive { max-height: 140px !important; }
            .table { font-size: 0.9rem; }
        }
        @media (max-width: 575.98px) {
            .table-responsive { max-height: 90px !important; }
            .table { font-size: 0.85rem; }
        }
    </style>

    <div class="row">       
        <div class="col-sm-3 mb-3 d-flex justify-content-center">
            <div class="card text-white bg-info shadow border-0 rounded-4 w-100" style="height: 100px;">
                <div class="card-body d-flex align-items-center">                    
                        {% if turno is not null %}
                            <div class="me-3 d-flex align-items-center justify-content-center" title="Registrar movimiento" data-action="click->sistema--app#registrarMov" style="height: 60px; width: 60px; background: rgba(255,255,255,0.12); border-radius: 50%;">
                            <i class="fas fa-user-clock fa-2x"></i>
                        {% else %}
                            <div class="me-3 d-flex align-items-center justify-content-center" title="Abrir turno" data-action="click->sistema--app#abrirTurno" style="height: 60px; width: 60px; background: #ffc7c7; border-radius: 50%; cursor:pointer">
                            <i class="fas fa-user-clock fa-2x text-danger"></i>
                        {% endif %}
                    </div>
                    <div class="flex-grow-1">
                        <div class="h6 fw-bold mb-1">{{ app.user.name }}</div>
                        <div class="card-title mb-1 fs-6">Turno actual - {{ turnoActual }}</div>                            
                    </div>
                </div>
            </div>
        </div>

        <div class="col-sm-3 mb-3 d-flex justify-content-center">
            <div class="card text-white bg-primary shadow border-0 rounded-4 w-100" style="height: 100px;">
                <div class="card-body d-flex align-items-center">
                    <div class="me-3 d-flex align-items-center justify-content-center" style="height: 60px; width: 60px; background: rgba(255,255,255,0.12); border-radius: 50%;">
                        <i class="fas fa-users fa-2x"></i>
                    </div>
                    <div class="flex-grow-1">
                        <div class="h2 fw-bold mb-1">{{ numClientes is defined ? numClientes : '0' }}</div>
                        <div class="card-title mb-1 fs-6">Clientes</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-3 mb-3 d-flex justify-content-center">
            <div class="card text-white bg-success shadow border-0 rounded-4 w-100" style="height: 100px; cursor:pointer;" data-bs-toggle="modal" data-bs-target="#modalHabitacionesPorPiso">
                <div class="card-body d-flex align-items-center">
                    <div class="me-3 d-flex align-items-center justify-content-center" style="height: 60px; width: 60px; background: rgba(255,255,255,0.12); border-radius: 50%;">
                        <i class="fas fa-bed fa-2x"></i>
                    </div>
                    <div class="flex-grow-1">
                        <div class="h2 fw-bold mb-1">{{habDis}}/{{habTot}}</div>
                        <div class="card-title mb-1 fs-6">Habitaciones disponibles</div>
                    </div>
                </div>
            </div>

            <!-- Modal habitaciones por piso -->
            <div class="modal fade" id="modalHabitacionesPorPiso" tabindex="-1" aria-labelledby="modalHabitacionesPorPisoLabel" aria-hidden="true">
                <div class="modal-dialog modal-xl">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="modalHabitacionesPorPisoLabel">Habitaciones</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                        </div>
                        <div class="modal-body">
                            {% if habitacionesPorPiso is defined and habitacionesPorPiso|length > 0 %}
                                {% for piso, habitaciones in habitacionesPorPiso %}
                                    <div class="mb-3">
                                        <h6 class="fw-bold">{{ piso }}</h6>
                                        <div class="row g-2">
                                            {% for habitacion in habitaciones %}
                                                <div class="col-6 col-md-3">
                                                    <div class="card card-habitacion text-center border-0 shadow-sm {% if habitacion.disponible == '1' %}
                                                                                                                        bg-success text-white
                                                                                                                    {% elseif habitacion.disponible == '2' %}
                                                                                                                        bg-danger text-white
                                                                                                                    {% elseif habitacion.disponible == '3' %}
                                                                                                                        bg-warning text-white
                                                                                                                    {% else %}
                                                                                                                        bg-secondary text-white
                                                                                                                    {% endif %}">
                                                        <div class="card-body p-2">
                                                            <div class="fw-bold">Hab {{ habitacion.nombre }}</div>
                                                            <div class="small">{{ habitacion.tipo }}</div>
                                                            <div class="small">
                                                                {% if habitacion.disponible == '1' %}
                                                                    Disponible
                                                                {% elseif habitacion.disponible == '2' %}
                                                                    Ocupada
                                                                {% elseif habitacion.disponible == '3' %}
                                                                    Aseo
                                                                {% else %}
                                                                    Mantenimiento
                                                                {% endif %}                                                        
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                {% endfor %}
                            {% else %}
                                <p>No hay habitaciones registradas por piso.</p>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <div class="col-sm-3 mb-3 d-flex justify-content-center">
            <div class="card text-white bg-warning shadow border-0 rounded-4 w-100" style="height: 100px;">
                <div class="card-body d-flex align-items-center">
                    <div class="me-3 d-flex align-items-center justify-content-center" style="height: 60px; width: 60px; background: rgba(255,255,255,0.18); border-radius: 50%;">
                        <i class="fas fa-percentage fa-2x"></i>
                    </div>
                    <div class="flex-grow-1">
                        <div class="h2 fw-bold mb-1">
                            {{ porcentaje ~ '%'}}
                        </div>
                        <div class="card-title mb-1 fs-6">Ocupación</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <div class="card shadow-sm border-0 rounded-4">
                <div class="card-body">
                    <h5 class="card-title mb-3">Reservas recientes</h5>
                    <div class="table-responsive" style="max-height: 300px; overflow-y: auto; ">
                        <table class="table table-striped table-hover align-middle mb-0 table-sm" style="min-width: 600px;">
                            <thead class="table-dark" style="position: sticky; top: 0; z-index: 2;">
                                <tr>
                                    <th style="background: #212529;">#</th>
                                    <th style="background: #212529;">Cliente</th>
                                    <th style="background: #212529;">Celular</th>
                                    <th style="background: #212529;">Fecha/Hora llegada</th>
                                    <th style="background: #212529;"># Habitaciones</th>
                                    <th style="background: #212529;">Aire</th>
                                    <th style="background: #212529;">Empresa</th>
                                    {#<th style="background: #212529;">Observaciones</th>#}
                                    <th style="background: #212529;">Turno</th>
                                    <th style="background: #212529;">Estado</th>
                                    <th colspan="2" style="background: #212529;">Acciones</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% if reservas is not empty %}
                                    {% for reserva in reservas %}
                                        <tr>
                                            <td>{{ '%05d'|format(reserva.numero) }}</td>
                                            <td>{{ reserva.person.name }} {{ reserva.person.lastname }}</td>
                                            <td>{{ reserva.person.cellphone }}</td>
                                            <td>{{ reserva.fechallegada|date('d-m-Y') }} / {{ reserva.horallegada|date('h:i a') }}</td>
                                            <td>{{ reserva.canthabitaciones }}</td>
                                            <td> {% if reserva.aire == 1 %} Si {% else %} No {% endif %} </td>                                            
                                            <td>
                                                {% if reserva.person.compania is not null %}
                                                    {{ reserva.person.compania.name }}
                                                {% endif %}
                                            </td>
                                            {#<td>{{ reserva.observaciones }}</td>#}
                                            <td>
                                               {{ reserva.turno.usuario.name }} - {{ '%05d'|format(reserva.turno.numero) }}
                                            </td>
                                             <td style="text-align:center">
                                                {% if reserva.status == 1 %}
                                                    <span class="badge bg-success">Pendiente</span>
                                                {% elseif reserva.status == 2 %}
                                                    <span class="badge bg-warning">Check-in</span>
                                                {% elseif reserva.status == 3 %}
                                                    <span class="badge bg-danger">Activa</span>
                                                {% elseif reserva.status == 4 %}
                                                    <span class="badge bg-secondary">Finalizada</span>
                                                {% else %}
                                                    <span class="badge bg-warning">Cancelada</span>
                                                {% endif %}
                                            </td>
                                            {% if turno is not null %}
                                                <td style="text-align:center; width: 20px;">                                                
                                                    {% if reserva.status == 1 %}
                                                        <i class="fas fa-check-circle text-primary" style="cursor:pointer; font-size: 12pt;" title="Check-in" data-action="click->sistema--app#crearCheckin" data-id="{{ reserva.id }}"></i>
                                                    {% else %}
                                                        <i class="fas fa-check-circle" style="cursor:pointer; color: #8db0e3; font-size: 12pt;" title="Check-in"></i>
                                                    {% endif %}
                                                </td>
                                                <td style="text-align:center; width: 20px;">                                                
                                                    {% if reserva.status == 1 or reserva.status == 2  %}
                                                        <i class="fas fa-trash-restore-alt text-danger" style="cursor:pointer; font-size: 12pt;" title="Cancelar reserva" data-action="click->sistema--app#eliminarReserva" data-id = '{{ reserva.id }}'></i>
                                                    {% else %}
                                                        <i class="fas fa-trash-restore-alt" style="cursor:pointer; font-size: 12pt; color:#e58e96" title="Cancelar reserva"></i>
                                                    {% endif %}                                                
                                                </td>
                                            {% else %}
                                                <td>
                                                    <span class="badge bg-secondary">Abrir turno</span>
                                                <td>
                                            {% endif %}
                                        </tr>
                                    {% endfor %}
                                {% else %}
                                    <tr>
                                        <td colspan="10" class="text-center">No hay reservas recientes.</td>
                                    </tr>
                                {% endif %}
                            </tbody>
                        </table>
                    </div>
                    <div class="mt-3 d-flex justify-content-space-between">
                        {% if turno is not null %}
                            <button type="button" class="btn btn-primary btn-sm" style="margin-right:10px" data-action="sistema--app#abrirModalNuevaReserva" data-accion = '1' data-id = '0'>Nuevo</button>
                        {% else %}
                            <button type="button" class="btn btn-sm" title="No se ha asignado un turno" style="margin-right:10px; background:#91c5f0; color:white">Nuevo</button>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para registrar reservas -->
    <div class="modal fade" id="modalNuevaReserva" data-turbo="false" data-sistema--app-target="modalNuevaReserva" tabindex="-1" aria-labelledby="modalNuevoClienteLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><span data-sistema--app-target="modalReservaLabel"></span></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form data-sistema--app-target="formNuevaReserva">
                    <input type="hidden" name="id" data-sistema--app-target="idReserva" value="0">
                    <div class="modal-body">
                        <div class="row mb-3">
                            <div class="col-md-8">
                                <label for="clienteSelect" class="form-label" style="font-weight: bold;">Cliente <i class="fas fa-exclamation-circle text-info" title="Crear cliente" style="" data-action="click->sistema--app#abrirModalNuevoCliente" data-accion="1"></i></label></label>
                                <select class="selectpicker form-control" data-controller="sistema--selectpicker" data-live-search-normalize="true" data-live-search="true" data-live-search-placeholder="Filtro clientes" data-size="5" name="clienteRev" data-sistema--app-target="clienteRev" data-action="change->sistema--app#obtenerDatosClienteReserva change->sistema--app#validaBtnGuardarReserva">
                                |   <option value="">Seleccione cliente</option>
                                    {% for cliente in clientes %}
                                        <option value="{{ cliente.id }}">{{ cliente.documentNumber }} - {{ cliente.name }} {{ cliente.lastname }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label for="cellCienteRev" class="form-label" style="font-weight: bold;">Numero de celular</label> 
                                <input type="text" name="cellCienteRev" class="form-control" id="cellCienteRev" data-sistema--app-target="cellCienteRev" readonly>
                            </div>                
                        </div>
                        <div class="row mb-3">                     
                            <div class="col-md-4">
                                <label for="fechaLlegClienteRev" class="form-label" style="font-weight: bold;">Fecha de llegada</label> 
                                <input type="date" name="fechaLlegClienteRev" class="form-control" id="fechaLlegClienteRev" data-sistema--app-target="fechaLlegClienteRev" placeholder="Ingrese el numero de celular" value="{{ "now"|date('Y-m-d') }}" min="{{ "now"|date('Y-m-d') }}" data-action="blur->sistema--app#validaBtnGuardarReserva">
                            </div>
                            <div class="col-md-4">
                                <label for="horaLlegClienteRev" class="form-label" style="font-weight: bold;">Hora de llegada</label> 
                                <input type="time" name="horaLlegClienteRev" class="form-control" id="horaLlegClienteRev" data-sistema--app-target="horaLlegClienteRev" min="{{ "now"|date('H:i') }}" data-action="blur->sistema--app#validaBtnGuardarReserva">
                            </div>
                            <div class="col-md-4">
                                <label for="selectAireRev" class="form-label" style="font-weight: bold;">Aire</label>
                                <select class="form-select" id="selectAireRev" name="selectAireRev" data-sistema--app-target="selectAireRev" data-action="change->sistema--app#validaBtnGuardarReserva">
                                    <option value="">Seleccione aire</option>
                                    <option value="1">Si</option>
                                    <option value="2">No</option>
                                </select>
                            </div>   
                        </div>            
                        <div class="row mb-3"> 
                            <div class="col-md-4">
                                <label for="cantHabClienteRev" class="form-label" style="font-weight: bold;">Cantidad de habitaciones</label>
                                <input type="text" name="cantHabClienteRev" class="form-control" id="cantHabClienteRev" data-sistema--app-target="cantHabClienteRev" data-action="blur->sistema--app#validaBtnGuardarReserva" >
                            </div>              
                            <div class="col-md-4">
                                <label for="numeroVehiculoClienteRev" class="form-label" style="font-weight: bold;">Numero de vehiculo</label>
                                <input type="text" name="numeroVehiculoClienteRev" class="form-control" id="numeroVehiculoClienteRev" data-sistema--app-target="numeroVehiculoClienteRev" readonly>
                            </div>
                            <div class="col-md-4">
                                <label for="companiaClienteRev" class="form-label" style="font-weight: bold;">Compañia</label>
                                <input type="text" name="companiaClienteRev" class="form-control" id="companiaClienteRev" data-sistema--app-target="companiaClienteRev" readonly>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-12">
                                <label for="observacionesReserva" class="form-label" style="font-weight: bold;">Observaciones</label> 
                                <textarea id="observacionesReserva" name="observacionesReserva" class="form-control" rows="2" data-sistema--app-target="observacionesRev" placeholder="Ingrese sus observaciones aquí" data-action="blur->sistema--app#validaBtnGuardarReserva"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" data-sistema--app-target="btnGuardarReserva" data-action="sistema--app#guardarReserva" disabled>Guardar</button>
                        <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal para hacer check-in -->
    {#<div class="modal fade" id="modalCheckin" data-turbo="false" data-sistema--app-target="modalCheckin" tabindex="-1" aria-labelledby="modalCheckinLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <input type="hidden" name="idCheckin" id="numCheckin"  value="1">
                <div class="modal-header">
                    <h5 class="modal-title"><span data-sistema--app-target="modalCheckinLabel">Check-in</span></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" data-sistema--app-target="modalBodyCheckin">
                </div>  
                <div class="modal-footer">
                    <div class="w-100 d-flex flex-wrap justify-content-start" data-sistema--app-target="botonesModalCheckin">
                    </div>
                </div>
            </div>
        </div>
    </div>#}

    {#<div class="modal fade" id="modalBuscarClienteCheckin" data-turbo="false" data-sistema--app-target="modalBuscarClienteCheckin" tabindex="-1" aria-labelledby="modalCheckinLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-sm">
            <div class="modal-content shadow-lg" style="box-shadow: 0 0.5rem 2rem rgba(33, 37, 41, 0.95) !important;">
                <div class="modal-header">
                    <h5 class="modal-title">Buscar cliente</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    <input type="text" id="inputBuscar" class="form-control" data-action="change->sistema--app#buscarCliente" placeholder="Nombres, Apellidos, Numero...">
                </div>
            </div>
        </div>
    </div>#}
    
    <!-- Modal para registrar servicios -->
    {#<div class="modal fade" id="modalNuevoServicioCheckin" data-sistema--app-target="modalNuevoServicioCheckin" tabindex="-1" aria-labelledby="modalNuevoServicioCheckinLabel" aria-hidden="true" style="margin-top:25px !important;">
        <div class="modal-dialog modal-lg">
            <div class="modal-content shadow-lg" style="box-shadow: 0 1.5rem 3.5rem 1rem rgba(33,37,41,0.98) !important;">
                <div class="modal-header">
                    <h5 class="modal-title">Registro de servicios</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>            
                <div class="modal-body">
                    <div class="row mb-3">
                        <div class="col-md-12">
                            <label for="selectServ" class="form-label" style="font-weight: bold;">Servicio</label> 
                            <select class="form-select" id="selectServ" name="selectServ" data-sistema--app-target="selectServ"  data-action="change->sistema--app#cargarServicioCheckin change->sistema--app#validaBtnGuardarServicioCheckin">
                                <option value="">Seleccione servicio</option>    
                                {% for servicio in serviciosSelector %}
                                    <option value="{{ servicio.id }}">{{ servicio.name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-12">
                            <label for="selectHabitacionServ" class="form-label" style="font-weight: bold;">Habitación</label> 
                            <select class="form-select" id="selectHabitacionServ" name="selectHabitacionServ" data-sistema--app-target="selectHabitacionServ"  data-action="change->sistema--app#validaBtnGuardarServicioCheckin">
                                <option value="">Seleccione habitación</option>                                
                            </select>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <label for="tipoDoc" class="form-label" style="font-weight: bold;">Valor</label> 
                            <input type="text" name="numeroDocCliente" class="form-control" data-sistema--app-target="valorServCheckin" disabled>
                        </div>
                        <div class="col-md-4">
                            <label for="tipoDoc" class="form-label" style="font-weight: bold;">Valor pagado</label> 
                            <input type="text" name="numeroDocCliente" class="form-control" data-sistema--app-target="valorPagServCheckin" data-action="blur->sistema--app#actualizaSaldoCheckin blur->sistema--app#validaBtnGuardarServicioCheckin">
                        </div>
                        <div class="col-md-4">
                            <label for="tipoDoc" class="form-label" style="font-weight: bold;">Saldo</label> 
                            <input type="text" name="numeroDocCliente" class="form-control" data-sistema--app-target="saldoServCheckin" disabled>
                        </div>
                    </div>
                    <div class="row mb-3">                        
                        <div class="col-md-6">
                            <label for="selectFormaPagoCheckin" class="form-label" style="font-weight: bold;">Forma de pago</label> 
                            <select class="form-select" id="selectFormaPagoCheckin" name="selectFormaPagoCheckin" data-sistema--app-target="selectFormaPagoCheckin"  data-action="change->sistema--app#actualizarComprobante change->sistema--app#validaBtnGuardarServicioCheckin">
                                <option value="">Seleccione forma de pago</option>                     
                                <option value="1">Efectivo</option>                     
                                <option value="2">Bono</option>                     
                                <option value="3">Transaccion</option>                     
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label for="tipoDoc" class="form-label" style="font-weight: bold;">N° comprobante</label> 
                            <input type="text" name="numeroDocCliente" class="form-control" data-sistema--app-target="comprobanteCheckin" disabled data-action="blur->sistema--app#validaBtnGuardarServicioCheckin">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-sistema--app-target="btnGuardarServicioCheckin" data-action="sistema--app#guardarServicioCheckin" disabled>Guardar</button>
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
                </div>
            </div>
        </div>
    </div>#}

    <!-- Modal para registrar clientes -->
    <div class="modal fade" id="modalNuevoCliente" style="margin-top:23px" data-sistema--app-target="modalNuevoCliente" tabindex="-1" aria-labelledby="modalNuevoClienteLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><span data-sistema--app-target="modalClienteLabel"></span></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form data-sistema--app-target="formNuevoCliente">
                    <input type="hidden" name="id" data-sistema--app-target="idCliente" value="0">
                    <div class="modal-body">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="tipoDoc" class="form-label" style="font-weight: bold;">Tipo de documento</label> 
                                <select class="form-select" id="tipoDoc" name="tipoDoc" data-sistema--app-target="selectTipoDocCliente"  data-action="change->sistema--app#validaBtnGuardarCliente">
                                    <option value="">Seleccione tipo de documento</option>
                                    {% for document in documents %}
                                        <option value="{{ document.id }}">{{ document.name }}</option>
                                    {% endfor %}                        
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="numeroDocCliente" class="form-label" style="font-weight: bold;">Numero de documento</label> 
                                <input type="text" name="numeroDocCliente" class="form-control" id="numeroDocCliente" data-sistema--app-target="numeroDocCliente" placeholder="Ingrese el numero de documento" data-action="blur->sistema--app#validaBtnGuardarCliente">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="nombresCliente" class="form-label" style="font-weight: bold;">Nombres</label> 
                                <input type="text" name="nombresCliente" class="form-control" id="nombresCliente" data-sistema--app-target="nombresCliente" placeholder="Ingrese los nombres" data-action="blur->sistema--app#validaBtnGuardarCliente">
                            </div>
                            <div class="col-md-6">
                                <label for="apellidosCliente" class="form-label" style="font-weight: bold;">Apellidos</label> 
                                <input type="text" name="apellidosCliente" class="form-control" id="apellidosCliente" data-sistema--app-target="apellidosCliente" placeholder="Ingrese los apellidos" data-action="blur->sistema--app#validaBtnGuardarCliente">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="numeroCelCliente" class="form-label" style="font-weight: bold;">Numero Celular</label> 
                                <input type="text" name="numeroCelCliente" class="form-control" id="numeroCelCliente" data-sistema--app-target="numeroCelCliente" placeholder="Ingrese el numero de celular" data-action="blur->sistema--app#validaBtnGuardarCliente">
                            </div>
                            <div class="col-md-6">
                                <label for="placaCliente" class="form-label" style="font-weight: bold;">Placa</label> 
                                <input type="text" name="placaCliente" class="form-control" id="placaCliente" data-sistema--app-target="placaCliente" placeholder="Ingrese el numero de la placa" data-action="blur->sistema--app#validaBtnGuardarCliente">
                            </div>
                        </div>              
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="numeroVehiculoCliente" class="form-label" style="font-weight: bold;">Numero de vehiculo</label> 
                                <input type="text" name="numeroVehiculoCliente" class="form-control" id="numeroVehiculoCliente" data-sistema--app-target="numeroVehiculoCliente" placeholder="Ingrese el numero del vehiculo" data-action="blur->sistema--app#validaBtnGuardarCliente">
                            </div>
                            <div class="col-md-6">
                                <label for="selectCompaniaCliente" class="form-label" style="font-weight: bold;">Compañia</label> 
                                <select class="form-select" id="selectCompaniaCliente" name="selectCompaniaCliente" data-sistema--app-target="selectCompaniaCliente"  data-action="change->sistema--app#validaBtnGuardarCliente">
                                    <option value="">Seleccione compañia</option>
                                    {% for compania in companias %}
                                        <option value="{{ compania.id }}">{{ compania.name }}</option>
                                    {% endfor %}                        
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" data-sistema--app-target="btnGuardarCliente" data-action="sistema--app#guardarClienteCheckin" disabled>Guardar</button>
                        <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>


    <!-- Modal para registrar movimientos -->
    <div class="modal fade" id="modalNuevoMov" data-sistema--app-target="modalNuevoMov" tabindex="-1" aria-labelledby="modalNuevoMov" aria-hidden="true" style="margin-top:25px !important;">
        <div class="modal-dialog modal-xl">
            <div class="modal-content shadow-lg" style="box-shadow: 0 1.5rem 3.5rem 1rem rgba(33,37,41,0.98) !important;">
                <div class="modal-header">
                    <h5 class="modal-title">Registro de Ventas</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>            
                <div class="modal-body">
                    <div class="row mb-3">
                        <div class="col-md-2">
                            <label for="selectServ" class="form-label" style="font-weight: bold;">Detalle</label> 
                            <select class="form-select" id="detalleVenta" name="selectServ" data-sistema--app-target="selectServ"  data-action="change->sistema--app#cargarSelectProductosMov change->sistema--app#validaBtnRegistroVenta">
                                <option value="1">Producto</option>    
                                <option value="2">Servicio</option>    
                            </select>
                        </div>
                        <div class="col-md-4" id="divProductos">
                            <label for="selectServ" class="form-label" style="font-weight: bold;">Productos</label> 
                            <select class="form-select" id="productoVenta" name="selectServ" data-sistema--app-target="selectServ" data-action="change->sistema--app#cargarproductoVenta change->sistema--app#validaBtnRegistroVenta">
                                <option value="">Seleccione producto</option>    
                                {% for producto in productos %}
                                    <option value="{{ producto.id }}">{{ producto.codigo}} - {{ producto.nombre}}</option>    
                                {% endfor %}    
                            </select>
                        </div>
                        <div class="col-md-4" id="divServicios" style="display:none">
                            <label for="selectServ" class="form-label" style="font-weight: bold;">Servicios</label> 
                            <select class="form-select" id="servicioVenta" name="selectServ" data-sistema--app-target="selectServ" data-action="change->sistema--app#cargarproductoVenta change->sistema--app#validaBtnRegistroVenta">
                                <option value="">Seleccione servicio</option>    
                                {% for servicio in selectServicios %}
                                    <option value="{{ servicio.id }}">{{ servicio.name }}</option>    
                                {% endfor %}    
                            </select>
                        </div>
                        <div class="col-md-2">
                            <label for="tipoDoc" class="form-label" style="font-weight: bold;">Valor und</label> 
                            <div class="input-group">
                                <input type="text" id="valorUndVenta" name="numeroDocCliente" class="form-control" placeholder='0' disabled>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <label for="tipoDoc" class="form-label" style="font-weight: bold;">Cantidad</label> 
                            <input type="text" id="cantVenta" name="numeroDocCliente" class="form-control" data-action="blur->sistema--app#calculoValProdVenta blur->sistema--app#validaBtnRegistroVenta">
                        </div>
                        <div class="col-md-2">
                            <label for="tipoDoc" class="form-label" style="font-weight: bold;">Valor</label> 
                            <div class="input-group">
                                <input type="text" id="valorVenta" name="numeroDocCliente" class="form-control" placeholder='0' disabled>
                                <button type="button" class="btn btn-success" id="btnRegistroVenta" data-action="click->sistema--app#registrarVenta" disabled><i class="fas fa-plus"></i></button>
                            </div>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <div class="table-responsive" style="overflow-x:auto; max-height: 38vh; overflow-y:auto;">
                                <table class="table table-bordered table-sm align-middle mb-0">
                                    <thead class="table-light">
                                        <tr>
                                            <th class="text-nowrap">Producto</th>
                                            <th class="text-nowrap">Cantidad</th>
                                            <th class="text-nowrap">Valor</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tablaVentas">
                                        {% if tablaVentas is not empty %}
                                            {% for item in tablaVentas %}
                                                <tr>
                                                    <td>{{ item.producto }}</td>
                                                    <td>{{ item.cantidad }}</td>
                                                    <td style="text-align:right">$ {{ item.valor|number_format(0,'.','.') }}</td>
                                                </tr>
                                            {% endfor %}
                                        {% else %}
                                            <tr>
                                                <td colspan= 4 style="text-align:center" >No se han registrado ventas</td>
                                            </tr>    
                                        {% endif %}                                                
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="table-responsive">
                                <table class="table table-bordered table-sm align-middle mb-0">
                                    <thead class="table-light">
                                        <tr>
                                            <th colspan="4" class="text-nowrap" style="text-align:center">Movimientos turno</th>
                                        </tr>
                                        <tr>
                                            <th class="text-nowrap">Concepto</th>
                                            <th class="text-nowrap">Recibido</th>
                                            <th class="text-nowrap">Pendiente</th>
                                            <th class="text-nowrap">Salida</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tablaMov">
                                        {% if tablaMov is not empty %}
                                            {% set valor = 0 %}
                                            {% set saldo = 0 %}
                                            {% set bonos = 0 %}

                                            {% for mov in tablaMov %}
                                                <tr>
                                                    <td>{{ mov.concepto }}</td>
                                                    <td style="text-align:right">$ {{ mov.valor|number_format(0,'.','.') }}</td>
                                                    <td style="text-align:right">$ {{ mov.pendiente|number_format(0,'.','.') }}</td>
                                                    <td style="text-align:right">$ {{ mov.bono|number_format(0,'.','.') }}</td>
                                                </tr>

                                                {% set valor = valor + mov.valor %}
                                                {% set saldo = saldo + mov.pendiente %}
                                                {% set bonos = bonos + mov.bono %}
                                            {% endfor %}
                                            <tr class="table-light">
                                                <td style="text-align:right; font-weight:bold">Totales</td>
                                                <td style="text-align:right; font-weight:bold">$ {{valor|number_format(0,'.','.')}}</td>
                                                <td style="text-align:right; font-weight:bold">$ {{saldo|number_format(0,'.','.')}}</td>
                                                <td style="text-align:right; font-weight:bold">$ {{bonos|number_format(0,'.','.')}}</td>
                                            </tr>
                                        {% else %}
                                            <tr class="table-light">
                                                <td colspan= 3 style="text-align:center" >No se han registrado movimientos</td>
                                            </tr>  
                                        {% endif %}                                                  
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-success" data-sistema--app-target="" data-action="sistema--app#abrirModalBono">Registrar bono</button>
                    <button type="button" class="btn btn-danger" data-sistema--app-target="" data-action="sistema--app#cerrarPeriodo">Cerrar turno</button>
                </div>
            </div>
        </div>
    </div>

     <!-- Modal para registrar bonos -->
    <div class="modal fade" id="modalNuevoBono" data-sistema--app-target="modalNuevoBono" tabindex="-1" aria-labelledby="modalNuevoBono" aria-hidden="true" style="margin-top:25px !important;">
        <div class="modal-dialog">
            <div class="modal-content shadow-lg" style="box-shadow: 0 1.5rem 3.5rem 1rem rgba(33,37,41,0.98) !important;">
                <div class="modal-header">
                    <h5 class="modal-title">Registro de Bonos</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>            
                <div class="modal-body">
                    <form data-sistema--app-target="formNewBono">
                        <div class="row mb-3 mt-2">
                            <div class="col-md-12">
                                <label for="selectServ" class="form-label" style="font-weight: bold;">A nombre de </label> 
                                <select id="beneficiarioBono" name="beneficiarioBono" class="form-control selectpicker"  data-live-search="true" data-live-search-placeholder="Filtro beneficiarios" data-size="5" title="Seleccione beneficiario" name="clienteRev" data-action="sistema--app#validaBtnGuardarBono">
                                    {% for cliente in beneficiariosSelector %}
                                        <option value="{{ cliente.id }}">{{ cliente.documentNumber }} - {{ cliente.name }} {{ cliente.lastname }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3 mt-2">
                            <div class="col-md-12">
                                <label for="selectServ" class="form-label" style="font-weight: bold;">Valor</label> 
                                <input type="text" id="valorBono" name="valorBono" class="form-control" data-action="sistema--app#formatearCampo blur->sistema--app#validaBtnGuardarBono">
                            </div>
                        </div>
                        <div class="row mb-3 mt-2">
                            <div class="col-md-12">
                                <label for="selectServ" class="form-label" style="font-weight: bold;">Detalle</label> 
                                <textarea id="detalleBono" name="detalleBono" class="form-control" rows="2" data-action="blur->sistema--app#validaBtnGuardarBono"></textarea>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-success" id="btnGuardarBono" data-action="sistema--app#registrarBono" disabled>Guardar</button>
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
                </div>
            </div>
        </div>
    </div>


    

    

</turbo-frame>